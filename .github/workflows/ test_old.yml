# Adapted from examples shown in https://autobencoder.com/2020-08-24-conda-actions/

name: ScrollStats Test

on: [push]

jobs:
  macos:
    name: ScrollStats Test on MacOS
    runs-on: "macos-latest"

    steps:
      - name: Checkout Branch
        uses: actions/checkout@v4
      - name: Setup Conda
        uses: conda-incubator/setup-miniconda@v3
        with:
          activate-environment: scroll
          environment-file: environment.yml
          auto-activate-base: false
      - name: Run Tests
        shell: bash -l {0}
        run: |
          curl http://download.osgeo.org/grass/mac/grass-7.8.8-arm64.dmg --output grass-7.8.8-arm64.dmg
          hdiutil attach grass-7.8.8-arm64.dmg
          cp -R /Volumes/GRASS-GIS-7.8.8/GRASS-7.8.app /Applications/
          pytest test_all.py

  # ubuntu:
  #   name: ScrollStats Test on MacOS
  #   runs-on: ubuntu-latest

  #   steps:
  #     - name: Checkout Branch
  #       uses: actions/checkout@v4
  #     - name: Setup Conda
  #       uses: conda-incubator/setup-miniconda@v3
  #       with:
  #         activate-environment: scroll
  #         environment-file: environment.yml
  #         auto-activate-base: false
  #     - name: Run Tests
  #       shell: bash -l {0}
  #       run: |
  #         sudo add-apt-repository ppa:ubuntugis/ubuntugis-unstable
  #         sudo apt update
  #         apt-get install grass=7.8.6-1~bionic1 
  #         pytest test_all.py